---
type: Documentation
domain: control-plane
origin: packages/control-plane/cmd/resolver/main.go
last_modified: 2026-02-01
generated: true
source: packages/control-plane/cmd/resolver/main.go
generated_at: 2026-02-01T19:25:56.154703
hash: e53a85af9c11df19f7caa52717a03e4fe1f512958c414471e02e77ad2ada38bc
---

## GlassOps Control Plane Resolver Documentation

This document describes the functionality of the GlassOps Control Plane Resolver, a command-line tool responsible for validating deployments against defined policies. It acts as a gatekeeper, ensuring deployments adhere to quality and architectural standards before proceeding.

**Package Purpose and Responsibilities**

The `main` package implements the core logic for the resolver. Its primary responsibility is to read a deployment contract generated by the runtime environment, resolve a relevant policy, and then enforce the rules defined within that policy against the contract data. If the deployment does not meet the policy requirements, the resolver blocks further progress.

**Key Types and Interfaces**

*   `contract.DeploymentContract`: This type, defined in the `github.com/glassops-platform/glassops-control-plane/internal/contract` package, represents the state of a deployment as reported by the runtime. It contains information about code coverage, static analysis results, and other quality metrics.
*   `policy.EffectivePolicy`: This type, defined in the `github.com/glassops-platform/glassops-control-plane/internal/policy` package, represents the resolved policy against which the deployment will be evaluated. It includes governance rules such as minimum code coverage and static analysis requirements.

**Important Functions and Their Behavior**

*   `main()`: This is the entry point of the resolver. It performs the following steps:
    1.  **Loads the Deployment Contract:** Reads the deployment contract from the file `.glassops/deployment-contract.json`. If the file is not found, the program exits with a fatal error.
    2.  **Resolves the Policy:** Calls the `policy.ResolvePolicy()` function to obtain the effective policy. In this example, it uses "devops-config.json" as the policy source and an 80.0 threshold.
    3.  **Enforces Quality Gates:**
        *   **Code Coverage:** Checks if the actual code coverage reported in the deployment contract is below the minimum coverage required by the policy. If it is, the program prints an error message and exits with a non-zero exit code (1).
        *   **Static Analysis:** Checks if static analysis is enabled in the policy and, if so, verifies that the deployment contract indicates static analysis passed. If static analysis is enabled but failed, the program prints an error message and exits with a non-zero exit code.
    4.  **Reports Success:** If all quality gates pass, the program prints a success message.

**Error Handling Patterns**

The resolver employs a straightforward error handling approach. Critical errors, such as the inability to read the deployment contract, are handled using `log.Fatalf()`, which prints an error message to the console and terminates the program.  Other errors, such as those potentially returned by `policy.ResolvePolicy()`, are currently ignored for simplicity, but should be handled more robustly in a production environment.

**Concurrency Patterns**

This version of the resolver does not employ any concurrency patterns (goroutines or channels). It operates as a single-threaded process.

**Notable Design Decisions**

*   **Policy Resolution:** The policy resolution is currently hardcoded to use a specific policy file ("devops-config.json") and threshold (80.0). This could be made more configurable through command-line arguments or environment variables.
*   **Contract Location:** The deployment contract is expected to be located at a fixed path (`.glassops/deployment-contract.json`). This simplifies deployment but may require adjustments for different environments.
*   **Exit Codes:** The resolver uses a non-zero exit code (1) to indicate failure, which is a standard practice for command-line tools and allows for easy integration into CI/CD pipelines.
*   **Gate Implementation:** The quality gates are implemented as simple `if` statements. More complex gating logic could be added as needed.

**Usage Instructions**

You must ensure that a valid `.glassops/deployment-contract.json` file exists in the current directory before running the resolver. This file should contain the deployment contract data in JSON format. You should also have a `devops-config.json` file available for policy resolution.